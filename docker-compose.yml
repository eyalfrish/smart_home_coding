# Smart Home Dashboard - Docker Compose Configuration
# 
# Usage:
#   Start:   docker compose up -d
#   Stop:    docker compose down
#   Logs:    docker compose logs -f
#   Rebuild: docker compose up -d --build
#   Update:  docker compose pull && docker compose up -d

services:
  dashboard:
    build:
      context: .
      dockerfile: Dockerfile
    image: smart-home-dashboard:latest
    container_name: smart-home-dashboard
    
    # Auto-restart on failure and after system reboot
    restart: unless-stopped
    
    # Port mapping: host:container
    # Access the dashboard at http://localhost:3000
    # Change the first port if you need a different host port
    ports:
      - "3000:3000"
    
    # Environment variables
    environment:
      - NODE_ENV=production
      - TZ=Asia/Jerusalem
    
    # Health check configuration
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    
    # Resource limits (optional, uncomment to enable)
    # deploy:
    #   resources:
    #     limits:
    #       memory: 512M
    #       cpus: '0.5'
    #     reservations:
    #       memory: 256M
    
    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

